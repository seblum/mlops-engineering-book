<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2.10 Secrets | MLOps Engineering</title>
  <meta name="description" content="Implementing an MLOps infrastructure with Airflow and MLFlow utilizing K8s, Terraform, and GithubActions." />
  <meta name="generator" content="bookdown 0.27 and GitBook 2.6.7" />

  <meta property="og:title" content="2.10 Secrets | MLOps Engineering" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Implementing an MLOps infrastructure with Airflow and MLFlow utilizing K8s, Terraform, and GithubActions." />
  <meta name="github-repo" content="seblum/mlops-engineering-book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2.10 Secrets | MLOps Engineering" />
  
  <meta name="twitter:description" content="Implementing an MLOps infrastructure with Airflow and MLFlow utilizing K8s, Terraform, and GithubActions." />
  

<meta name="author" content="Sebastian Blum" />


<meta name="date" content="2023-02-15" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="configmaps.html"/>
<link rel="next" href="health-checks.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preamble</a>
<ul>
<li class="chapter" data-level="" data-path="topics.html"><a href="topics.html"><i class="fa fa-check"></i>Topics</a></li>
<li class="chapter" data-level="0.1" data-path="exemplary-deployment.html"><a href="exemplary-deployment.html"><i class="fa fa-check"></i><b>0.1</b> Exemplary Deployment</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="terraform.html"><a href="terraform.html"><i class="fa fa-check"></i><b>1</b> Terraform</a>
<ul>
<li class="chapter" data-level="1.1" data-path="prerequisites.html"><a href="prerequisites.html"><i class="fa fa-check"></i><b>1.1</b> Prerequisites</a></li>
<li class="chapter" data-level="1.2" data-path="basic-usage.html"><a href="basic-usage.html"><i class="fa fa-check"></i><b>1.2</b> Basic usage</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="basic-usage.html"><a href="basic-usage.html#terraform-init"><i class="fa fa-check"></i><b>1.2.1</b> terraform init</a></li>
<li class="chapter" data-level="1.2.2" data-path="basic-usage.html"><a href="basic-usage.html#terraform-validate"><i class="fa fa-check"></i><b>1.2.2</b> terraform validate</a></li>
<li class="chapter" data-level="1.2.3" data-path="basic-usage.html"><a href="basic-usage.html#terraform-plan"><i class="fa fa-check"></i><b>1.2.3</b> terraform plan</a></li>
<li class="chapter" data-level="1.2.4" data-path="basic-usage.html"><a href="basic-usage.html#terraform-apply"><i class="fa fa-check"></i><b>1.2.4</b> terraform apply</a></li>
<li class="chapter" data-level="1.2.5" data-path="basic-usage.html"><a href="basic-usage.html#terraform-destroy"><i class="fa fa-check"></i><b>1.2.5</b> terraform destroy</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="core-concepts.html"><a href="core-concepts.html"><i class="fa fa-check"></i><b>1.3</b> Core Concepts</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="core-concepts.html"><a href="core-concepts.html#providers"><i class="fa fa-check"></i><b>1.3.1</b> Providers</a></li>
<li class="chapter" data-level="1.3.2" data-path="core-concepts.html"><a href="core-concepts.html#resources"><i class="fa fa-check"></i><b>1.3.2</b> Resources</a></li>
<li class="chapter" data-level="1.3.3" data-path="core-concepts.html"><a href="core-concepts.html#data-sources"><i class="fa fa-check"></i><b>1.3.3</b> Data Sources</a></li>
<li class="chapter" data-level="1.3.4" data-path="core-concepts.html"><a href="core-concepts.html#state"><i class="fa fa-check"></i><b>1.3.4</b> State</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="modules.html"><a href="modules.html"><i class="fa fa-check"></i><b>1.4</b> Modules</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="modules.html"><a href="modules.html#input-variables"><i class="fa fa-check"></i><b>1.4.1</b> Input Variables</a></li>
<li class="chapter" data-level="1.4.2" data-path="modules.html"><a href="modules.html#output-variables"><i class="fa fa-check"></i><b>1.4.2</b> Output Variables</a></li>
<li class="chapter" data-level="1.4.3" data-path="modules.html"><a href="modules.html#local-variables"><i class="fa fa-check"></i><b>1.4.3</b> Local Variables</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="additional-tips-tricks.html"><a href="additional-tips-tricks.html"><i class="fa fa-check"></i><b>1.5</b> Additional tips &amp; tricks</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="additional-tips-tricks.html"><a href="additional-tips-tricks.html#count"><i class="fa fa-check"></i><b>1.5.1</b> count</a></li>
<li class="chapter" data-level="1.5.2" data-path="additional-tips-tricks.html"><a href="additional-tips-tricks.html#for-each"><i class="fa fa-check"></i><b>1.5.2</b> for-each</a></li>
<li class="chapter" data-level="1.5.3" data-path="additional-tips-tricks.html"><a href="additional-tips-tricks.html#for"><i class="fa fa-check"></i><b>1.5.3</b> for</a></li>
<li class="chapter" data-level="1.5.4" data-path="additional-tips-tricks.html"><a href="additional-tips-tricks.html#workspaces"><i class="fa fa-check"></i><b>1.5.4</b> Workspaces</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="kubernetes.html"><a href="kubernetes.html"><i class="fa fa-check"></i><b>2</b> Kubernetes</a>
<ul>
<li class="chapter" data-level="2.1" data-path="prerequisites-1.html"><a href="prerequisites-1.html"><i class="fa fa-check"></i><b>2.1</b> Prerequisites</a></li>
<li class="chapter" data-level="2.2" data-path="core-concepts-1.html"><a href="core-concepts-1.html"><i class="fa fa-check"></i><b>2.2</b> Core Concepts</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="core-concepts-1.html"><a href="core-concepts-1.html#nodes"><i class="fa fa-check"></i><b>2.2.1</b> Nodes</a></li>
<li class="chapter" data-level="2.2.2" data-path="core-concepts-1.html"><a href="core-concepts-1.html#pods"><i class="fa fa-check"></i><b>2.2.2</b> Pods</a></li>
<li class="chapter" data-level="" data-path="core-concepts-1.html"><a href="core-concepts-1.html#imperative-declarative-management"><i class="fa fa-check"></i>Imperative &amp; Declarative Management</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="application-deployment-design.html"><a href="application-deployment-design.html"><i class="fa fa-check"></i><b>2.3</b> Application Deployment &amp; Design</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="application-deployment-design.html"><a href="application-deployment-design.html#deployments"><i class="fa fa-check"></i><b>2.3.1</b> Deployments</a></li>
<li class="chapter" data-level="2.3.2" data-path="application-deployment-design.html"><a href="application-deployment-design.html#resource-management"><i class="fa fa-check"></i><b>2.3.2</b> Resource Management</a></li>
<li class="chapter" data-level="2.3.3" data-path="application-deployment-design.html"><a href="application-deployment-design.html#daemonsets"><i class="fa fa-check"></i><b>2.3.3</b> DaemonSets</a></li>
<li class="chapter" data-level="2.3.4" data-path="application-deployment-design.html"><a href="application-deployment-design.html#statefulsets"><i class="fa fa-check"></i><b>2.3.4</b> StatefulSets</a></li>
<li class="chapter" data-level="2.3.5" data-path="application-deployment-design.html"><a href="application-deployment-design.html#jobs-cron-jobs"><i class="fa fa-check"></i><b>2.3.5</b> Jobs &amp; Cron Jobs</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="services-networking.html"><a href="services-networking.html"><i class="fa fa-check"></i><b>2.4</b> Services &amp; Networking</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="services-networking.html"><a href="services-networking.html#services"><i class="fa fa-check"></i><b>2.4.1</b> Services</a></li>
<li class="chapter" data-level="2.4.2" data-path="services-networking.html"><a href="services-networking.html#exemplary-setup-of-database-and-frontend-microservices"><i class="fa fa-check"></i><b>2.4.2</b> Exemplary setup of database and frontend microservices</a></li>
<li class="chapter" data-level="2.4.3" data-path="services-networking.html"><a href="services-networking.html#service-discovery"><i class="fa fa-check"></i><b>2.4.3</b> Service Discovery</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="volume-storage.html"><a href="volume-storage.html"><i class="fa fa-check"></i><b>2.5</b> Volume &amp; Storage</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="volume-storage.html"><a href="volume-storage.html#emptydir-volume"><i class="fa fa-check"></i><b>2.5.1</b> EmptyDir Volume</a></li>
<li class="chapter" data-level="2.5.2" data-path="volume-storage.html"><a href="volume-storage.html#hostpath-volume"><i class="fa fa-check"></i><b>2.5.2</b> HostPath Volume</a></li>
<li class="chapter" data-level="2.5.3" data-path="volume-storage.html"><a href="volume-storage.html#persistent-volumes"><i class="fa fa-check"></i><b>2.5.3</b> Persistent Volumes</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="environment-configuration-security.html"><a href="environment-configuration-security.html"><i class="fa fa-check"></i><b>2.6</b> Environment, Configuration &amp; Security</a></li>
<li class="chapter" data-level="2.7" data-path="namespaces.html"><a href="namespaces.html"><i class="fa fa-check"></i><b>2.7</b> Namespaces</a></li>
<li class="chapter" data-level="2.8" data-path="labels-selectors-and-annotations.html"><a href="labels-selectors-and-annotations.html"><i class="fa fa-check"></i><b>2.8</b> Labels, Selectors and Annotations</a></li>
<li class="chapter" data-level="2.9" data-path="configmaps.html"><a href="configmaps.html"><i class="fa fa-check"></i><b>2.9</b> ConfigMaps</a></li>
<li class="chapter" data-level="2.10" data-path="secrets.html"><a href="secrets.html"><i class="fa fa-check"></i><b>2.10</b> Secrets</a>
<ul>
<li class="chapter" data-level="2.10.1" data-path="secrets.html"><a href="secrets.html#exemplary-use-case-of-secrets"><i class="fa fa-check"></i><b>2.10.1</b> Exemplary use case of secrets</a></li>
</ul></li>
<li class="chapter" data-level="2.11" data-path="health-checks.html"><a href="health-checks.html"><i class="fa fa-check"></i><b>2.11</b> Health Checks</a>
<ul>
<li class="chapter" data-level="2.11.1" data-path="health-checks.html"><a href="health-checks.html#liveness-probe"><i class="fa fa-check"></i><b>2.11.1</b> Liveness Probe</a></li>
<li class="chapter" data-level="2.11.2" data-path="health-checks.html"><a href="health-checks.html#readiness-probe"><i class="fa fa-check"></i><b>2.11.2</b> Readiness Probe</a></li>
</ul></li>
<li class="chapter" data-level="2.12" data-path="helm.html"><a href="helm.html"><i class="fa fa-check"></i><b>2.12</b> Helm</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="airflow.html"><a href="airflow.html"><i class="fa fa-check"></i><b>3</b> Airflow</a>
<ul>
<li class="chapter" data-level="3.1" data-path="prerequisites-2.html"><a href="prerequisites-2.html"><i class="fa fa-check"></i><b>3.1</b> Prerequisites</a></li>
<li class="chapter" data-level="3.2" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html"><i class="fa fa-check"></i><b>3.2</b> Fundamental concepts</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#dags"><i class="fa fa-check"></i><b>3.2.1</b> DAGs</a></li>
<li class="chapter" data-level="3.2.2" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#operators"><i class="fa fa-check"></i><b>3.2.2</b> Operators</a></li>
<li class="chapter" data-level="3.2.3" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#tasks"><i class="fa fa-check"></i><b>3.2.3</b> Tasks</a></li>
<li class="chapter" data-level="3.2.4" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#scheduling"><i class="fa fa-check"></i><b>3.2.4</b> Scheduling</a></li>
<li class="chapter" data-level="3.2.5" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#xcom"><i class="fa fa-check"></i><b>3.2.5</b> XCom</a></li>
<li class="chapter" data-level="3.2.6" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#taskflow"><i class="fa fa-check"></i><b>3.2.6</b> Taskflow</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="exemplary-ml-workflow.html"><a href="exemplary-ml-workflow.html"><i class="fa fa-check"></i><b>3.3</b> Exemplary ML workflow</a></li>
<li class="chapter" data-level="3.4" data-path="airflow-infrastructure.html"><a href="airflow-infrastructure.html"><i class="fa fa-check"></i><b>3.4</b> Airflow infrastructure</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="airflow-infrastructure.html"><a href="airflow-infrastructure.html#airflow-as-a-distributed-system"><i class="fa fa-check"></i><b>3.4.1</b> Airflow as a distributed system</a></li>
<li class="chapter" data-level="3.4.2" data-path="airflow-infrastructure.html"><a href="airflow-infrastructure.html#scheduler-1"><i class="fa fa-check"></i><b>3.4.2</b> Scheduler</a></li>
<li class="chapter" data-level="3.4.3" data-path="airflow-infrastructure.html"><a href="airflow-infrastructure.html#webserver"><i class="fa fa-check"></i><b>3.4.3</b> Webserver</a></li>
<li class="chapter" data-level="3.4.4" data-path="airflow-infrastructure.html"><a href="airflow-infrastructure.html#executor"><i class="fa fa-check"></i><b>3.4.4</b> Executor</a></li>
<li class="chapter" data-level="3.4.5" data-path="airflow-infrastructure.html"><a href="airflow-infrastructure.html#dag-directory"><i class="fa fa-check"></i><b>3.4.5</b> DAG Directory</a></li>
<li class="chapter" data-level="3.4.6" data-path="airflow-infrastructure.html"><a href="airflow-infrastructure.html#metadata-database"><i class="fa fa-check"></i><b>3.4.6</b> Metadata Database</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">MLOps Engineering</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="secrets" class="section level2 hasAnchor" number="2.10">
<h2><span class="header-section-number">2.10</span> Secrets<a href="secrets.html#secrets" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Secrets, as the name suggests, store and manage sensitive information. However, secrets are actually not secrets in K8s. They can quite easily decoded using <code>kubectl describe</code> on a secret and decode it using the shell command <code>echo &lt;password&gt; | base64 -d</code>. Thus, sensitive information like database password should never be stored in secrets. There are much better ressources to store such data, for example a Vault on the cloud provider itself. However, secret can be used so that you donâ€™t need to include confidential data in your application code. Since they are stored and created independently of the Pods that use them, there is less risk of being exposed during the workflow of creating, viewing, and editing Pods.</p>
<p>It is possible to create secrets using imperative approach as shown below.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb55-1"><a href="secrets.html#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create the two secrets db-password and api-token</span></span>
<span id="cb55-2"><a href="secrets.html#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> create secret generic mysecret-from-cli <span class="at">--from-literal</span><span class="op">=</span>db-password=123 <span class="at">--from-literal</span><span class="op">=</span>api-token=token</span>
<span id="cb55-3"><a href="secrets.html#cb55-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-4"><a href="secrets.html#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="co"># output the new secret as yaml</span></span>
<span id="cb55-5"><a href="secrets.html#cb55-5" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> get secret mysecret <span class="at">-o</span> yaml</span>
<span id="cb55-6"><a href="secrets.html#cb55-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-7"><a href="secrets.html#cb55-7" aria-hidden="true" tabindex="-1"></a><span class="co"># create a file called secret with a file-password in it</span></span>
<span id="cb55-8"><a href="secrets.html#cb55-8" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;super-save-password&quot;</span> <span class="op">&gt;</span> secret </span>
<span id="cb55-9"><a href="secrets.html#cb55-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-10"><a href="secrets.html#cb55-10" aria-hidden="true" tabindex="-1"></a><span class="co"># create a secret from file</span></span>
<span id="cb55-11"><a href="secrets.html#cb55-11" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> create secret generic mysecret-from-file <span class="at">--from-file</span><span class="op">=</span>secret</span></code></pre></div>
<p>Similar to ConfigMaps, secrets are accessed via an environment variable or a volume.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb56-1"><a href="secrets.html#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># secrets.yaml</span></span>
<span id="cb56-2"><a href="secrets.html#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> apps/v1</span></span>
<span id="cb56-3"><a href="secrets.html#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> Deployment</span></span>
<span id="cb56-4"><a href="secrets.html#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb56-5"><a href="secrets.html#cb56-5" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> secrets</span></span>
<span id="cb56-6"><a href="secrets.html#cb56-6" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb56-7"><a href="secrets.html#cb56-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">selector</span><span class="kw">:</span></span>
<span id="cb56-8"><a href="secrets.html#cb56-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">matchLabels</span><span class="kw">:</span></span>
<span id="cb56-9"><a href="secrets.html#cb56-9" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">app</span><span class="kw">:</span><span class="at"> secrets</span></span>
<span id="cb56-10"><a href="secrets.html#cb56-10" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">template</span><span class="kw">:</span></span>
<span id="cb56-11"><a href="secrets.html#cb56-11" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb56-12"><a href="secrets.html#cb56-12" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">labels</span><span class="kw">:</span></span>
<span id="cb56-13"><a href="secrets.html#cb56-13" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">app</span><span class="kw">:</span><span class="at"> secrets</span></span>
<span id="cb56-14"><a href="secrets.html#cb56-14" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb56-15"><a href="secrets.html#cb56-15" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">volumes</span><span class="kw">:</span></span>
<span id="cb56-16"><a href="secrets.html#cb56-16" aria-hidden="true" tabindex="-1"></a><span class="co">        # get the secret from a volume</span></span>
<span id="cb56-17"><a href="secrets.html#cb56-17" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> secret-vol</span></span>
<span id="cb56-18"><a href="secrets.html#cb56-18" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">secret</span><span class="kw">:</span></span>
<span id="cb56-19"><a href="secrets.html#cb56-19" aria-hidden="true" tabindex="-1"></a><span class="co">            # the name of the secret we created earlier</span></span>
<span id="cb56-20"><a href="secrets.html#cb56-20" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="fu">secretName</span><span class="kw">:</span><span class="at"> mysecret-from-cli</span></span>
<span id="cb56-21"><a href="secrets.html#cb56-21" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">containers</span><span class="kw">:</span></span>
<span id="cb56-22"><a href="secrets.html#cb56-22" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> secrets</span></span>
<span id="cb56-23"><a href="secrets.html#cb56-23" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">image</span><span class="kw">:</span><span class="at"> busybox</span></span>
<span id="cb56-24"><a href="secrets.html#cb56-24" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">volumeMounts</span><span class="kw">:</span></span>
<span id="cb56-25"><a href="secrets.html#cb56-25" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="kw">-</span><span class="at"> </span><span class="fu">mountPath</span><span class="kw">:</span><span class="at"> /etc/secrets</span></span>
<span id="cb56-26"><a href="secrets.html#cb56-26" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="fu">name</span><span class="kw">:</span><span class="at"> secret-vol</span></span>
<span id="cb56-27"><a href="secrets.html#cb56-27" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">env</span><span class="kw">:</span></span>
<span id="cb56-28"><a href="secrets.html#cb56-28" aria-hidden="true" tabindex="-1"></a><span class="co">          # nane of the secret in the container</span></span>
<span id="cb56-29"><a href="secrets.html#cb56-29" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> CUSTOM_SECRET</span></span>
<span id="cb56-30"><a href="secrets.html#cb56-30" aria-hidden="true" tabindex="-1"></a><span class="co">            # get the secret from an environment variable</span></span>
<span id="cb56-31"><a href="secrets.html#cb56-31" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="fu">valueFrom</span><span class="kw">:</span></span>
<span id="cb56-32"><a href="secrets.html#cb56-32" aria-hidden="true" tabindex="-1"></a><span class="at">              </span><span class="fu">secretKeyRef</span><span class="kw">:</span></span>
<span id="cb56-33"><a href="secrets.html#cb56-33" aria-hidden="true" tabindex="-1"></a><span class="co">                # name and key of the secret we created earlier</span></span>
<span id="cb56-34"><a href="secrets.html#cb56-34" aria-hidden="true" tabindex="-1"></a><span class="at">                </span><span class="fu">name</span><span class="kw">:</span><span class="at"> mysecret-from-file</span></span>
<span id="cb56-35"><a href="secrets.html#cb56-35" aria-hidden="true" tabindex="-1"></a><span class="at">                </span><span class="fu">key</span><span class="kw">:</span><span class="at"> secret</span></span>
<span id="cb56-36"><a href="secrets.html#cb56-36" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">command</span><span class="kw">:</span></span>
<span id="cb56-37"><a href="secrets.html#cb56-37" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="kw">-</span><span class="at"> </span><span class="st">&quot;sleep&quot;</span></span>
<span id="cb56-38"><a href="secrets.html#cb56-38" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="kw">-</span><span class="at"> </span><span class="st">&quot;3600&quot;</span></span>
<span id="cb56-39"><a href="secrets.html#cb56-39" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">resources</span><span class="kw">:</span></span>
<span id="cb56-40"><a href="secrets.html#cb56-40" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">limits</span><span class="kw">:</span></span>
<span id="cb56-41"><a href="secrets.html#cb56-41" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="fu">memory</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;128Mi&quot;</span></span>
<span id="cb56-42"><a href="secrets.html#cb56-42" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="fu">cpu</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;500m&quot;</span></span></code></pre></div>
<div id="exemplary-use-case-of-secrets" class="section level3 hasAnchor" number="2.10.1">
<h3><span class="header-section-number">2.10.1</span> Exemplary use case of secrets<a href="secrets.html#exemplary-use-case-of-secrets" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>When pulling from a private dockerhub repository, applying the deployment will throw an error since there are no username and password specified. As they should not be coded into the deployment yaml itself, they can be accessed via a secret. In fact, a specific secret can be specified for docker registry. The secret can be specified using the imperative approach.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb57-1"><a href="secrets.html#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kubectl</span> create secret docker-registry docker-hub-private <span class="dt">\</span></span>
<span id="cb57-2"><a href="secrets.html#cb57-2" aria-hidden="true" tabindex="-1"></a>--docker-username=YOUR_USERNAME <span class="dt">\</span></span>
<span id="cb57-3"><a href="secrets.html#cb57-3" aria-hidden="true" tabindex="-1"></a>--docker-password=YOUR_PASSWORD <span class="dt">\</span></span>
<span id="cb57-4"><a href="secrets.html#cb57-4" aria-hidden="true" tabindex="-1"></a>--docker-email=YOUR_EMAIL</span></code></pre></div>
<p>Finally, the secret is specified in the deployment configuration where it can be accessed during application.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb58-1"><a href="secrets.html#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># secret_dockerhub.yaml</span></span>
<span id="cb58-2"><a href="secrets.html#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> apps/v1</span></span>
<span id="cb58-3"><a href="secrets.html#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> Deployment</span></span>
<span id="cb58-4"><a href="secrets.html#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb58-5"><a href="secrets.html#cb58-5" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> secret-app</span></span>
<span id="cb58-6"><a href="secrets.html#cb58-6" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb58-7"><a href="secrets.html#cb58-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">selector</span><span class="kw">:</span></span>
<span id="cb58-8"><a href="secrets.html#cb58-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">matchLabels</span><span class="kw">:</span></span>
<span id="cb58-9"><a href="secrets.html#cb58-9" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">app</span><span class="kw">:</span><span class="at"> secret-app</span></span>
<span id="cb58-10"><a href="secrets.html#cb58-10" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">template</span><span class="kw">:</span></span>
<span id="cb58-11"><a href="secrets.html#cb58-11" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb58-12"><a href="secrets.html#cb58-12" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">labels</span><span class="kw">:</span></span>
<span id="cb58-13"><a href="secrets.html#cb58-13" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">app</span><span class="kw">:</span><span class="at"> secret-app</span></span>
<span id="cb58-14"><a href="secrets.html#cb58-14" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb58-15"><a href="secrets.html#cb58-15" aria-hidden="true" tabindex="-1"></a><span class="co">      # specifiy the docker-registry secret to be accessed</span></span>
<span id="cb58-16"><a href="secrets.html#cb58-16" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">imagePullSecrets</span><span class="kw">:</span></span>
<span id="cb58-17"><a href="secrets.html#cb58-17" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> docker-hub-private</span></span>
<span id="cb58-18"><a href="secrets.html#cb58-18" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">containers</span><span class="kw">:</span></span>
<span id="cb58-19"><a href="secrets.html#cb58-19" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> secret-app</span></span>
<span id="cb58-20"><a href="secrets.html#cb58-20" aria-hidden="true" tabindex="-1"></a><span class="co">        # of course you need an own private repository</span></span>
<span id="cb58-21"><a href="secrets.html#cb58-21" aria-hidden="true" tabindex="-1"></a><span class="co">        # to pull and change the name accordingly</span></span>
<span id="cb58-22"><a href="secrets.html#cb58-22" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">image</span><span class="kw">:</span><span class="at"> seblum/private:cat-v1</span></span>
<span id="cb58-23"><a href="secrets.html#cb58-23" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">resources</span><span class="kw">:</span></span>
<span id="cb58-24"><a href="secrets.html#cb58-24" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">limits</span><span class="kw">:</span></span>
<span id="cb58-25"><a href="secrets.html#cb58-25" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="fu">memory</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;128Mi&quot;</span></span>
<span id="cb58-26"><a href="secrets.html#cb58-26" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="fu">cpu</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;500m&quot;</span></span>
<span id="cb58-27"><a href="secrets.html#cb58-27" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">ports</span><span class="kw">:</span></span>
<span id="cb58-28"><a href="secrets.html#cb58-28" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">containerPort</span><span class="kw">:</span><span class="at"> </span><span class="dv">80</span></span></code></pre></div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="configmaps.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="health-checks.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": true,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/seblum/kubernetes-training/edit/master/04.5-Kubernetes-Environment_Configuration_and_Security.md",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
